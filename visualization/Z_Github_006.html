<html>
    
    <head>
        <script src="https://d3js.org/d3.v3.min.js"></script>
    </head>
    
    <body>
        
        <svg width="10000"></svg>
        
        <script>
        
            d3.csv('athletes_sochi.csv', function(data){
                console.log(data)
                
                var rects = d3.select('svg')
                    .selectAll('rect')
                    .data(data)
                    .enter()
                    .append('rect')
                    .attr('height', function(d, i){
                        return d.age
                    })
                    .attr('width', 5)
                    .attr('x', function(d, i){
                        return i*6
                    })
                    .attr('y', function(d, i){
                        return 100-d.age
                    })
                    .attr('opacity', 0)
                    
                rects.transition()
                    .duration(2500)
                    .delay(function(d, i){
                        return 100*i
                    })
                    .attr('opacity', 1)
                
                rects.on('click', function(d, i){
                    
                    if(d.clicked){
                        d3.select(this)
                            .attr('fill', 'black')
                        d.clicked = false
                    }else{
                        d3.select(this)
                            .attr('fill', 'red')
                        d.clicked = true
                    }
                    
                    
                })
                    
                   
                
            })
            
            
        
        </script>
    </body>

</html>